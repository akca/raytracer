foreach pixel s:
	compute the viewing ray r (from e to s)
	tmin = ∞, obj = NULL
	foreach object o:
		if r intersects o at point x:
			if t < tmin:
				tmin = t, obj = o
	if obj not NULL: // viewing ray intersected with an object
		pixel color = La // ambient shading is not affected by shadows
		foreach light l:
			compute the shadow ray s from x to l
			foreach object p:
				if s intersects p before the light source:
					continue the light loop; // point is in shadow – no contribution from this light
		pixel color += Ld + Ls // add diffuse and specular components for this light source
	else
		pixel color = color of background (or black)s
